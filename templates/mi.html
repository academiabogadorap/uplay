{% extends "base.html" %}
{% block title %}Mi panel{% endblock %}
{% block content %}
  <h2 style="margin:6px 0 8px;">¬°Hola, {{ jugador.nombre_completo }}!</h2>
  <p class="muted" style="margin:0 0 10px;">
    Categor√≠a: <strong>{{ jugador.categoria.nombre if jugador.categoria else '-' }}</strong> ‚Äî
    Puntos: <strong>{{ jugador.puntos }}</strong>
    {% if en_zona %}
      <span class="badge badge-ok" style="margin-left:6px;">En zona de ascenso</span>
    {% endif %}
  </p>

  <!-- Bot√≥n de acci√≥n r√°pida: Cambiar PIN -->
  <p style="margin:0 0 12px;">
    <a href="{{ url_for('mi_cambiar_pin') }}" class="btn btn-ghost btn-slim">Cambiar PIN</a>
  </p>

  <!-- üöÄ Accesos r√°pidos (NUEVO): Torneos -->
  <div class="card" style="margin: 0 0 12px;">
    <h3 style="display:flex; align-items:center; gap:8px; margin-bottom:6px;">
      Accesos r√°pidos
      <span class="badge">nuevo</span>
    </h3>
    <div class="muted" style="margin-bottom:8px;">Entr√° a los torneos p√∫blicos y anotate si hay cupo.</div>
    <div class="flex-row" style="display:flex; gap:8px; flex-wrap:wrap;">
      <a href="{{ url_for('torneos_public_list') }}" class="btn">Ver torneos</a>
      <a href="{{ url_for('torneos_public_list', estado='INSCRIPCION') }}" class="btn btn-ghost btn-slim">Con inscripci√≥n abierta</a>
      {# Si m√°s adelante agregamos filtro por categor√≠a en /torneos, podemos sumar: 
         <a href="{{ url_for('torneos_public_list', categoria_id=jugador.categoria_id) }}" class="btn btn-ghost btn-slim">De mi categor√≠a</a> #}
    </div>
  </div>

  <!-- Tareas pendientes -->
  <div class="card">
    <h3>Tareas pendientes</h3>
    <ul class="list-clean">
      {# 0) Partidos directos para responder #}
      {% set cant_part_pend = (partidos_para_responder|length) if partidos_para_responder else 0 %}
      {% if cant_part_pend > 0 %}
        <li>
          Ten√©s <strong>{{ cant_part_pend }}</strong> partido(s) para responder invitaci√≥n.
          <a href="#partidos-para-responder" class="btn btn-ghost btn-slim">Ver</a>
        </li>
      {% else %}
        <li class="muted">No ten√©s partidos para responder invitaci√≥n.</li>
      {% endif %}

      {# 0.bis) Responder resultado #}
      {% set cant_responder_result = (cant_partidos_resultado_para_responder or 0) %}
      {% if cant_responder_result > 0 %}
        <li>
          Ten√©s <strong>{{ cant_responder_result }}</strong> partido(s) para <strong>responder resultado</strong>.
          <a href="#partidos-resultado-para-responder" class="btn btn-ghost btn-slim">Responder ahora</a>
        </li>
      {% else %}
        <li class="muted">No ten√©s partidos para responder resultado.</li>
      {% endif %}

      {# 1) Partidos sin resultado #}
      {% if cant_pend_sin_result > 0 %}
        <li>
          Ten√©s <strong>{{ cant_pend_sin_result }}</strong> partido(s) sin resultado.
          <a href="{{ url_for('partidos_list') }}" class="btn btn-ghost btn-slim">Cargar ahora</a>
        </li>
      {% else %}
        <li class="muted">No ten√©s partidos pendientes de resultado.</li>
      {% endif %}

      {# 2) Desaf√≠os para responder #}
      {% set cant_desaf_pend = (desafios_para_responder|length) if desafios_para_responder else 0 %}
      {% if cant_desaf_pend > 0 %}
        <li>
          Te desafiaron en <strong>{{ cant_desaf_pend }}</strong> desaf√≠o(s) pendiente(s).
          <a href="{{ url_for('desafios_list') }}" class="btn btn-ghost btn-slim">Ver</a>
        </li>
      {% else %}
        <li class="muted">No ten√©s desaf√≠os para responder.</li>
      {% endif %}

      {# 2.bis) Suplencias activas #}
      {% if cant_suplencias and cant_suplencias > 0 %}
        <li>
          Est√°s anotado como <strong>suplente</strong> en <strong>{{ cant_suplencias }}</strong> abierto(s).
          <a href="#suplencias-activas" class="btn btn-ghost btn-slim">Ver</a>
        </li>
      {% endif %}

      {# 3) Posibilidad de desafiar #}
      {% if puede_desafiar and cat_superior %}
        <li>
          Est√°s en zona de ascenso. Pod√©s desafiar a <strong>{{ cat_superior.nombre }}</strong>.
          <a href="{{ url_for('desafios_new', desafiante_id=jugador.id) }}" class="btn btn-ghost btn-slim">Crear desaf√≠o</a>
        </li>
      {% else %}
        <li class="muted">No pod√©s desafiar al nivel superior por ahora.</li>
      {% endif %}

      {# 4) Abiertos de mi categor√≠a #}
      {% if cant_abiertos_mi_cat > 0 %}
        <li>
          Hay <strong>{{ cant_abiertos_mi_cat }}</strong> partidos abiertos en tu categor√≠a.
          <a href="{{ url_for('abiertos_list') }}" class="btn btn-ghost btn-slim">Ver</a>
        </li>
      {% else %}
        <li>No hay partidos abiertos en tu categor√≠a.
          <a href="{{ url_for('abiertos_list') }}" class="btn btn-ghost btn-slim" style="margin-left:4px;">Crear uno</a>
        </li>
      {% endif %}
    </ul>
  </div>

  {# --- Bloque informativo de Torneos (NUEVO) --- #}
  <div class="card" style="margin-top:12px;">
    <h3>Torneos</h3>
    <p class="muted">Consult√° torneos p√∫blicos, cupos y anotate si est√°n en inscripci√≥n.</p>
    <div class="flex-row" style="display:flex; gap:8px; flex-wrap:wrap;">
      <a href="{{ url_for('torneos_public_list') }}" class="btn">Ver torneos</a>
      <a href="{{ url_for('torneos_public_list', estado='INSCRIPCION') }}" class="btn btn-ghost btn-slim">Con inscripci√≥n abierta</a>
    </div>
  </div>

  {# --- Partidos para responder invitaci√≥n --- #}
  {% if partidos_para_responder and partidos_para_responder|length > 0 %}
    <div id="partidos-para-responder" class="card">
      <h3>Partidos para responder (invitaci√≥n)</h3>
      <ul class="list-clean">
        {% for p in partidos_para_responder %}
          <li style="margin-bottom:6px;">
            <span class="badge">#{{ p.id }}</span>
            {% if p.categoria %}[{{ p.categoria.nombre }}]{% endif %}
            ‚Äî Propuesto por: {{ p.creador.nombre_completo if p.creador else '(creador desconocido)' }}<br>
            Tu equipo:
            {% if p.companero %}
              {{ jugador.nombre_completo }} + {{ p.companero.nombre_completo }}
            {% else %}
              {{ jugador.nombre_completo }} + <span class="muted">(sin compa√±ero)</span>
            {% endif %}<br>
            Rivales propuestos:
            {% if p.rival1 and p.rival2 %}
              {{ p.rival1.nombre_completo }} + {{ p.rival2.nombre_completo }}
            {% else %}
              <span class="muted">(incompletos)</span>
            {% endif %}
            <a href="{{ url_for('partidos_responder', partido_id=p.id) }}" class="btn btn-ok btn-slim" style="margin-left:6px;">Responder</a>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  {# --- Partidos con resultado propuesto --- #}
  {% if partidos_resultado_para_responder and partidos_resultado_para_responder|length > 0 %}
    <div id="partidos-resultado-para-responder" class="card">
      <h3>Partidos para responder resultado</h3>
      <ul class="list-clean">
        {% for p in partidos_resultado_para_responder %}
          <li style="margin-bottom:6px;">
            <span class="badge">#{{ p.id }}</span> ‚Äî {{ p.categoria.nombre if p.categoria else '-' }} ‚Äî {{ p.estado }}
            {% if p.fecha %} ‚Äî {{ p.fecha.strftime('%Y-%m-%d %H:%M') }}{% endif %}
            <a href="{{ url_for('partidos_confirmar_resultado', partido_id=p.id) }}" class="btn btn-ok btn-slim" style="margin-left:6px;">Responder resultado</a>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  {# --- Desaf√≠os para responder --- #}
  {% if desafios_para_responder and desafios_para_responder|length > 0 %}
    <div class="card">
      <h3>Desaf√≠os para responder</h3>
      <ul class="list-clean">
        {% for d in desafios_para_responder %}
          <li style="margin-bottom:6px;">
            <strong>{{ d.desafiante.nombre_completo }}</strong> + {{ d.companero.nombre_completo }}
            desafiaron a <strong>{{ d.categoria_superior.nombre if d.categoria_superior else 'nivel superior' }}</strong>.
            Rivales propuestos: {{ d.rival1.nombre_completo }} + {{ d.rival2.nombre_completo }}.
            {% if d.estado == 'ACEPTADO_PARCIAL' %}
              <span class="badge badge-warn" style="margin-left:6px;">el otro rival ya acept√≥</span>
            {% endif %}
            <a href="{{ url_for('desafios_responder', desafio_id=d.id) }}" class="btn btn-ok btn-slim" style="margin-left:6px;">Responder</a>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  {# --- Suplencias activas --- #}
  {% if suplencias and suplencias|length > 0 %}
    <div id="suplencias-activas" class="card">
      <h3>Suplencias activas</h3>
      <ul class="list-clean">
        {% for s in suplencias %}
          {% set pa = s.partido_abierto %}
          <li style="margin-bottom:6px;">
            <span class="badge">Abierto #{{ pa.id }}</span>
            ‚Äî {{ pa.categoria.nombre if pa.categoria else '-' }}
            ‚Äî {{ pa.nota or 'Sin nota' }}
            ‚Äî Inscriptos: {{ pa.inscriptos|length if pa.inscriptos else 0 }}/4
            ‚Äî Estado:
            <span class="badge {% if pa.estado=='ABIERTO' %}badge-ok{% elif pa.estado in ['LLENO','PARTIDO_CREADO'] %}badge-warn{% elif pa.estado=='CANCELADO' %}badge-danger{% endif %}">
              {{ pa.estado }}
            </span>
            <form method="post" action="{{ url_for('abiertos_suplente_quitar', pa_id=pa.id) }}" style="display:inline; margin-left:6px;">
              <button type="submit" class="btn btn-ghost btn-slim">Quitarme</button>
            </form>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  <div class="grid-2" style="margin:12px 0;">
    <!-- Crear partido abierto -->
    <div class="card">
      <h3>Crear partido abierto</h3>
      <p class="muted">Arm√° un partido de {{ jugador.categoria.nombre }} y compart√≠ el link para que se unan (hasta 4).</p>
      <form method="post" action="{{ url_for('abiertos_new') }}">
        <input type="hidden" name="categoria_id" value="{{ jugador.categoria_id }}">
        <input type="hidden" name="creador_id" value="{{ jugador.id }}">
        <input name="nota" placeholder="Ej: hoy 20:00 en Club X">
        <div style="margin-top:8px;">
          <button type="submit" class="btn">Crear partido</button>
        </div>
      </form>
    </div>

    <!-- Unirme a un partido -->
    <div class="card">
      <h3>Unirme a un partido</h3>
      {% if abiertos_cat %}
        <ul class="list-clean">
          {% for pa in abiertos_cat %}
            {% set cant = pa.inscriptos|length if pa.inscriptos else 0 %}
            {% set lleno = (cant >= 4) %}
            {% set ya_esta = pa.inscriptos | selectattr('jugador_id', 'equalto', jugador.id) | list %}
            {% set suplentes = pa.suplentes if pa.suplentes else [] %}
            {% set ya_suplente = (pa.id in mis_suplencias_pa_ids) %}

            <li style="margin-bottom:8px;">
              <span class="badge">#{{ pa.id }}</span> ‚Äî {{ pa.nota or 'Sin nota' }} ‚Äî
              <span class="badge {% if pa.estado=='ABIERTO' %}badge-ok{% elif pa.estado in ['LLENO','PARTIDO_CREADO'] %}badge-warn{% elif pa.estado=='CANCELADO' %}badge-danger{% endif %}">
                {{ pa.estado }}
              </span>
              ‚Äî Inscriptos: {{ cant }}/4 ‚Äî
              <span class="badge">Suplentes: {{ suplentes|length }}</span>
              {% if suplentes and suplentes|length > 0 %}
                <span class="muted">
                  (
                  {% for s in suplentes %}
                    {{ s.jugador.nombre_completo }}{% if not loop.last %}, {% endif %}
                  {% endfor %}
                  )
                </span>
              {% endif %}

              {# Acciones #}
              {% if ya_esta %}
                <form method="post" action="{{ url_for('abiertos_leave', pa_id=pa.id) }}" style="display:inline; margin-left:6px;">
                  <input type="hidden" name="jugador_id" value="{{ jugador.id }}">
                  <button type="submit" class="btn btn-danger btn-slim">Salir</button>
                </form>
              {% else %}
                {% if pa.estado == 'ABIERTO' and not lleno %}
                  {# Elegibles libres #}
                  {% set ya_elegidos = pa.inscriptos
                                        | selectattr('partner_pref')
                                        | map(attribute='partner_pref')
                                        | map(attribute='id')
                                        | list %}
                  {% set elegibles = [] %}
                  {% for it in pa.inscriptos %}
                    {% set id_j = it.jugador.id %}
                    {% set fue_elegido = id_j in ya_elegidos %}
                    {% set el_eligio_a_otro = it.partner_pref is not none %}
                    {% if id_j != jugador.id and (not fue_elegido) and (not el_eligio_a_otro) %}
                      {% set _ = elegibles.append(it.jugador) %}
                    {% endif %}
                  {% endfor %}

                  <form method="post" action="{{ url_for('abiertos_join', pa_id=pa.id) }}" style="display:inline; margin-left:6px;">
                    <select name="partner_pref_id">
                      <option value="" selected>Sin preferencia (cualquiera)</option>
                      {% for jug in elegibles %}
                        <option value="{{ jug.id }}">{{ jug.nombre_completo }}</option>
                      {% endfor %}
                    </select>
                    <button type="submit" class="btn btn-slim" style="margin-left:6px;">Unirme</button>
                  </form>
                {% else %}
                  {% if ya_suplente %}
                    <span class="badge badge-ok" style="margin-left:6px;">Ya sos suplente</span>
                    <form method="post" action="{{ url_for('abiertos_suplente_quitar', pa_id=pa.id) }}" style="display:inline; margin-left:6px;">
                      <button type="submit" class="btn btn-ghost btn-slim">Quitarme</button>
                    </form>
                  {% else %}
                    <form method="post" action="{{ url_for('abiertos_suplente', pa_id=pa.id) }}" style="display:inline; margin-left:6px;">
                      <button type="submit" class="btn btn-ghost btn-slim">Proponerme como suplente</button>
                    </form>
                  {% endif %}
                {% endif %}
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="muted">No hay partidos abiertos en tu categor√≠a por ahora.</p>
      {% endif %}
      <p style="margin-top:6px;"><a href="{{ url_for('abiertos_list') }}" class="btn btn-ghost btn-slim">Ver todos</a></p>
    </div>

    <!-- Desafiar nivel superior -->
    <div class="card">
      <h3>Desafiar nivel superior</h3>
      {% if en_zona and cat_superior %}
        <p>Pod√©s desafiar a <strong>{{ cat_superior.nombre }}</strong>. Eleg√≠ compa√±ero y rivales:</p>
        {% if rivales_superior %}
          <ul class="list-clean" style="max-height:160px; overflow:auto;">
            {% for r in rivales_superior %}
              <li>{{ r.nombre_completo }} ‚Äî {{ r.puntos }} pts</li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="muted">No hay rivales listados a√∫n en {{ cat_superior.nombre }}.</p>
        {% endif %}
        <p style="margin-top:6px;">
          <a href="{{ url_for('desafios_new', desafiante_id=jugador.id) }}" class="btn btn-ok btn-slim">Crear desaf√≠o</a>
        </p>
      {% elif not cat_superior %}
        <p class="muted">Est√°s en la categor√≠a m√°s alta.</p>
      {% else %}
        <p class="muted">Necesit√°s estar en zona de ascenso para desafiar.</p>
        <a href="{{ url_for('ranking') }}" class="btn btn-ghost btn-slim">Ver ranking</a>
      {% endif %}
    </div>

    <!-- Mis pr√≥ximos partidos -->
    <div class="card">
      <h3>Mis pr√≥ximos partidos</h3>
      {% if partidos_pend and partidos_pend|length > 0 %}
        <ul class="list-clean">
          {% for m in partidos_pend[:5] %}
            {% set necesita_ok = (m.rival1_id and m.rival2_id) and not (m.rival1_acepto and m.rival2_acepto) %}
            {% set hay_propuesta = m.propuesta_abierta() %}
            <li>
              <span class="badge">#{{ m.id }}</span> ‚Äî {{ m.categoria.nombre if m.categoria else '-' }} ‚Äî {{ m.estado }}
              {% if m.fecha %} ‚Äî {{ m.fecha.strftime('%Y-%m-%d %H:%M') }}{% endif %}

              {% if necesita_ok %}
                <span class="badge badge-warn" style="margin-left:6px;">esperando aceptaci√≥n de rivales</span>
              {% elif m.necesita_respuesta_de(jugador.id) %}
                <a href="{{ url_for('partidos_confirmar_resultado', partido_id=m.id) }}" class="btn btn-ok btn-slim" style="margin-left:6px;">Responder resultado</a>
              {% elif m.puede_proponer_resultado(jugador.id) %}
                <a href="{{ url_for('partidos_resultado', partido_id=m.id) }}" class="btn btn-slim" style="margin-left:6px;">Proponer resultado</a>
              {% elif hay_propuesta %}
                <span class="badge badge-ok" style="margin-left:6px;">propuesta enviada</span>
              {% else %}
                <a href="{{ url_for('partidos_list') }}" class="btn btn-ghost btn-slim" style="margin-left:6px;">Ver</a>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="muted">Sin pendientes.</p>
      {% endif %}
      <p style="margin-top:6px;"><a href="{{ url_for('partidos_list') }}" class="btn btn-ghost btn-slim">Ver todos</a></p>
    </div>
  </div>

  <!-- √öltimos resultados -->
  <div class="card" style="margin-top:6px;">
    <h3>√öltimos resultados</h3>
    {% if partidos_jug and partidos_jug|length > 0 %}
      <ul class="list-clean">
        {% for m in partidos_jug %}
          <li>
            <span class="badge">#{{ m.id }}</span> ‚Äî {{ m.categoria.nombre if m.categoria else '-' }} ‚Äî
            {% if m.resultado %}
              {% set g = m.resultado.ganador_pareja_id %}
              {% if g == m.pareja1_id %}
                Gan√≥: {{ m.pareja1.jugador1.nombre_completo }} + {{ m.pareja1.jugador2.nombre_completo }}
              {% elif g == m.pareja2_id %}
                Gan√≥: {{ m.pareja2.jugador1.nombre_completo }} + {{ m.pareja2.jugador2.nombre_completo }}
              {% else %}
                Ganador no identificado
              {% endif %}
              {% if m.resultado.sets_text %} ‚Äî {{ m.resultado.sets_text }}{% endif %}
            {% else %}
              <span class="muted">(sin detalle)</span>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="muted">Sin resultados recientes.</p>
    {% endif %}
  </div>
{% endblock %}

{% block help_content %}
<style>
  /* ==== Modal de ayuda compacto con scroll propio ==== */
  .help-container{ display:flex; justify-content:center; width:100%; }
  .help-wrap{
    width: min(800px, 90vw);
    margin: 0 auto;

    /* Altura reducida + scroll en el contenedor */
    max-height: 62dvh;
    max-height: 62vh;   /* fallback */
    overflow: auto;
    overscroll-behavior: contain;

    position: relative;
    background: transparent;
  }

  /* Header compacto y sticky */
  .help-head{
    position: sticky; top: 0; z-index: 2;
    display:flex; align-items:center; gap:6px;
    padding:6px 6px; margin-bottom:4px;
    background: var(--bg, rgba(10,12,20,.96));
    border-bottom:1px solid rgba(255,255,255,.06);
  }
  .help-title{ margin:0; font-size: clamp(.92rem, 2vw, 1.02rem); }
  .help-sub{   margin:0; color:var(--muted,#98a2b3); font-size: clamp(.78rem, 1.7vw, .88rem); }

  /* Grid */
  .help-grid{
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(236px, 1fr));
    gap:8px;
  }

  /* Cards */
  .help-card{
    background: rgba(255,255,255,.04);
    border:1px solid rgba(255,255,255,.08);
    border-radius:10px;
    padding:6px;
  }
  .help-card h4{
    display:flex; align-items:center; gap:6px;
    margin:0 0 4px;
    font-size: clamp(.88rem, 1.9vw, .96rem);
  }
  .help-card p, .help-card li{
    margin:3px 0;
    font-size: clamp(.78rem, 1.6vw, .86rem);
    line-height:1.3;
  }
  .help-ul, .help-ol{ padding-left:16px; margin:4px 0; }

  .help-badges { display:flex; gap:6px; flex-wrap:wrap; margin-top:4px; }
  .chip{ display:inline-block; padding:2px 7px; border-radius:999px; font-size:.76rem; border:1px solid #2a2f45; background:#1b2138;}
  .chip.ok{ background:#1b3b2a; border-color:#1a704d; }
  .chip.warn{ background:#3b2f1b; border-color:#704d1a; }
  .chip.info{ background:#1b2f3b; border-color:#1a4d70; }
  .chip.danger{ background:#3b1b1b; border-color:#701a1a; }

  .help-visual{
    display:flex; align-items:center; justify-content:center;
    background: rgba(255,255,255,.03);
    border:1px dashed rgba(255,255,255,.12);
    border-radius:10px; padding:6px;
  }
  .help-visual svg, .help-card img{ max-width:100%; height:auto; display:block; }

  @media (max-width:540px){
    .help-grid{ grid-template-columns: 1fr; }
    .help-card h4 svg{ display:none; }
  }
</style>

<div class="help-container">
  <div class="help-wrap">
    <div class="help-head">
      <h3 class="help-title">¬øQu√© puedo hacer en ‚ÄúMi panel‚Äù?</h3>
      <p class="help-sub">Resumen de tareas, accesos y estados</p>
    </div>

    <div class="help-grid">
      <!-- Qu√© es -->
      <section class="help-card">
        <h4>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M4 6h16M4 12h10M4 18h8" stroke="currentColor"/></svg>
          ¬øQu√© est√°s viendo?
        </h4>
        <p>Tu panel personal con atajos para <strong>crear o unirte</strong> a partidos, <strong>responder</strong> invitaciones y <strong>confirmar resultados</strong>.</p>
        <div class="help-badges">
          <span class="chip ok">Zona de ascenso</span>
          <span class="chip info">Crear abierto</span>
          <span class="chip warn">Responder</span>
        </div>
      </section>

      <!-- Tareas pendientes -->
      <section class="help-card">
        <h4>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M6 6h12v12H6z" stroke="currentColor"/></svg>
          Tareas pendientes
        </h4>
        <ul class="help-ul">
          <li><strong>Responder invitaci√≥n:</strong> cuando te proponen un partido.</li>
          <li><strong>Responder resultado:</strong> confirmar o rechazar marcador propuesto.</li>
          <li><strong>Partidos sin resultado:</strong> carg√° el score para cerrar.</li>
          <li><strong>Desaf√≠os recibidos:</strong> acept√° o rechaz√°.</li>
          <li><strong>Suplencias:</strong> gestion√° en qu√© abiertos est√°s de suplente.</li>
        </ul>
      </section>

      <!-- Crear/Unirme -->
      <section class="help-card">
        <h4>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 2v20M2 12h20" stroke="currentColor"/></svg>
          Crear o unirme
        </h4>
        <ul class="help-ul">
          <li><strong>Crear abierto:</strong> arm√° un partido en tu categor√≠a y compartilo.</li>
          <li><strong>Unirme:</strong> busc√° abiertos de tu categor√≠a y eleg√≠ compa√±ero (opcional).</li>
          <li><strong>Suplente:</strong> si no hay cupo, pod√©s proponerte.</li>
        </ul>
      </section>

      <!-- Desafiar nivel superior -->
      <section class="help-card">
        <h4>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="currentColor"/></svg>
          Desafiar nivel superior
        </h4>
        <p>Si est√°s en <strong>zona de ascenso</strong> y existe una <strong>categor√≠a superior</strong>, pod√©s crear un desaf√≠o con compa√±ero y dos rivales.</p>
      </section>

      <!-- Pr√≥ximos partidos y resultados -->
      <section class="help-card">
        <h4>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M8 12h8M12 8v8" stroke="currentColor"/></svg>
          Pr√≥ximos & Resultados
        </h4>
        <ul class="help-ul">
          <li><strong>Pr√≥ximos:</strong> estados, aceptaci√≥n de rivales y acciones r√°pidas (proponer/confirmar).</li>
          <li><strong>√öltimos resultados:</strong> pareja ganadora y sets.</li>
        </ul>
      </section>

      <!-- Tips -->
      <section class="help-card">
        <h4>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 2l3 7h7l-5.5 4 2 7-6.5-4.5L5 20l2-7L1 9h7l4-7z" stroke="currentColor"/></svg>
          Tips r√°pidos
        </h4>
        <ul class="help-ul">
          <li>Si no ves ‚ÄúCrear desaf√≠o‚Äù, a√∫n no est√°s en zona o no hay nivel superior.</li>
          <li>En abiertos, us√° <em>Sin preferencia</em> si te da lo mismo el compa√±ero.</li>
          <li>Confirm√° resultados dentro de las 12h para evitar autocierre.</li>
        </ul>
      </section>

      <!-- Visual ligero -->
      <section class="help-card">
        <h4>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><rect x="4" y="4" width="16" height="16" rx="3" stroke="currentColor"/></svg>
          Vista r√°pida
        </h4>
        <div class="help-visual">
          <svg width="260" height="110" viewBox="0 0 280 120" aria-hidden="true">
            <rect x="1" y="1" width="278" height="118" rx="10" fill="#0f172a" stroke="rgba(255,255,255,.12)"/>
            <rect x="16" y="14" width="248" height="18" rx="5" fill="#132238"/>
            <text x="140" y="27" fill="#9fb3c8" font-size="10" text-anchor="middle">Mi Panel ‚Äî Atajos</text>
            <rect x="24" y="46" width="96" height="22" rx="6" fill="#1b3b2a"/><text x="72" y="60" fill="#fff" font-size="10" text-anchor="middle">Crear abierto</text>
            <rect x="152" y="46" width="104" height="22" rx="6" fill="#1b2f3b"/><text x="204" y="60" fill="#fff" font-size="10" text-anchor="middle">Responder</text>
            <rect x="24" y="78" width="104" height="22" rx="6" fill="#3b2f1b"/><text x="76" y="92" fill="#fff" font-size="10" text-anchor="middle">Cargar resultado</text>
            <rect x="152" y="78" width="104" height="22" rx="6" fill="#1b3b2a"/><text x="204" y="92" fill="#fff" font-size="10" text-anchor="middle">Desafiar</text>
          </svg>
        </div>
      </section>
    </div>
  </div>
</div>
{% endblock %}
